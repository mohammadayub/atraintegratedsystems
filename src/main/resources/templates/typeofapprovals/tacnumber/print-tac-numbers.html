<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: page_head}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=EB+Garamond&display=swap" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

    <title>TAC Numbers List</title>

    <style>
        body {
            background-color: #f5f5f5;
            font-family: 'EB Garamond', serif;
            font-weight: bold;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        #content {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            width: 80%;
            max-width: 900px;
            margin: 20px auto;
            text-align: center;
        }


        th, td {
            padding: 6px;
            text-align: center;
            vertical-align: middle;
            font-size: 0.85em;
            border: 1px solid #ddd;
        }

        thead th {
            background-color: #007bff;
            color: white;
        }

        tbody tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        nav .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 6px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        nav .pagination .page-link {
            border-radius: 50% !important;
        }

        #search-form input {
            width: 250px;
        }

        /* Center wrappers */
        .center-wrapper {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .table-container {
            width: 70%;       /* limit table width */
            max-width: 700px;
        }
    </style>
</head>
<body>
<nav th:replace="~{typeofApproval_layout :: page_navbar}"></nav>

<div id="content" class="mt-4">

    <!-- Print + Search Row -->
    <!-- Print Button + Search Form Row -->
    <div class="d-flex justify-content-center align-items-start mb-3 gap-3 flex-wrap">

        <!-- Left: Print Button -->
        <div class="d-flex">
            <button class="btn btn-primary" onclick="doPrint()" id="prnt">Print</button>
        </div>

        <!-- Right: Search Form -->
        <div id="search-form">
            <form th:action="@{/typeofapprovals/tacnumber/tacnumbers-list-print-search}" method="get" class="d-flex gap-3">
                <input type="text" placeholder="Company Name ...." name="keyword" class="form-control"
                        th:value="${keyword}">
                <button type="submit" class="btn btn-primary">Search</button>
            </form>
        </div>

    </div>


    <!-- Table -->
    <div>
        <div>
            <table class="table-bordered" style="margin:0 auto; border-collapse: separate; border-spacing: 0 10px;">
                <thead>
                <tr>
                    <th class="text-center">TAC No</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="row : ${tacNumbers}" class="mt-4">
                    <td class="mt-4">
                        <img th:src="@{/images/favicon.png}" alt="ATRA"
                             style="width:16px; height:16px; margin-right:5px;" />
                        <span th:text="${row.tacNo}"></span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Pagination -->
    <div class="d-flex justify-content-center">
        <nav th:if="${!isSearch}" id="pagination_id" style="margin:0 auto;">
            <ul class="pagination">

                <!-- First -->
                <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/typeofapprovals/tacnumber/tacnumbers-list-print(page=0, size=10)}">&laquo;</a>
                </li>

                <!-- Previous -->
                <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/typeofapprovals/tacnumber/tacnumbers-list-print(page=${currentPage-1}, size=10)}">&lsaquo;</a>
                </li>

                <!-- Page numbers -->
                <li class="page-item"
                    th:each="i : ${#numbers.sequence((currentPage > 2 ? currentPage-2 : 0),
                                             (currentPage+2 < totalPages-1 ? currentPage+2 : totalPages-1))}"
                    th:classappend="${i == currentPage} ? 'active'">
                    <a class="page-link"
                       th:href="@{/typeofapprovals/tacnumber/tacnumbers-list-print(page=${i}, size=10)}"
                       th:text="${i+1}"></a>
                </li>

                <!-- Next -->
                <li class="page-item" th:classappend="${currentPage+1 >= totalPages} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/typeofapprovals/tacnumber/tacnumbers-list-print(page=${currentPage+1}, size=10)}">&rsaquo;</a>
                </li>

                <!-- Last -->
                <li class="page-item" th:classappend="${currentPage+1 >= totalPages} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/typeofapprovals/tacnumber/tacnumbers-list-print(page=${totalPages-1}, size=10)}">&raquo;</a>
                </li>
            </ul>
        </nav>
    </div>
</div>

<div style="height:10vh;"></div>
<footer th:replace="~{layout :: page_footer}"></footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.querySelector("input[name='keyword']").addEventListener("input", function() {
        if (this.value.trim() === "") {
            window.location.href = "/typeofapprovals/tacnumber/tacnumbers-list-print";
        }
    });

    function doPrint() {
    const printBtn = document.getElementById("prnt");
    const searchForm = document.getElementById("search-form");
    const pagination = document.getElementById("pagination_id");

    if (printBtn) printBtn.style.display = 'none';
    if (searchForm) searchForm.style.display = 'none';
    if (pagination) pagination.style.display = 'none';

    window.print();

    if (printBtn) printBtn.style.display = 'inline-block';
    if (searchForm) searchForm.style.display = 'block';
    if (pagination) pagination.style.display = 'block';
}

</script>
</body>
</html>
